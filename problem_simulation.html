<!DOCTYPE html>
<html lang="en">
    <head>
        <title></title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="media/css/style.css" rel="stylesheet">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
        <script src="scripts/jQuery_script.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    </head>
    <body>
        <div class="modal fade" id="InfoModal">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title" id="InfoModalLabel">E-waste Problem Simulation</h3>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <h4 class="modal-h2">How to play?</h4>
                        <p class="modal-p">You want to buy the new IPhone 14 from the market, which was at the price of 3000 AED.
                        However, because of the raising E-waste issue its price increased to 5000 AED.
                        Watch out for its price, and return its price to the original state.</p>
                        <h5>To win the game you must</h5>
                        <ul>
                            <li>Put every electronic device into the Ultimate Recycling Machine.</li>
                            <li>Press the "Purchase" button to buy new IPhone 14 when its price becomes less than or equal to its original price, which is 3000 AED.</li>
                            <li>Watch out for its price not to increase to more than 5000 AED.</li>
                        </ul>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="start-game">Start the Game</button>
                    </div>
                </div>
            </div>
        </div>
        <main id="main-game">
            <article class="flex flex-column">
                <section>
                    <img class="URM-img">
                </section>
                <section class="e-wastes">
                    <div>

                    </div>
                </section>
                <section>
                    <h4 id="price"><span>5000</span> AED</h4>
                    <button class="btn btn-secondary" id="buy">Purchase</button>
                </section>
            </article>
        </main>
        <script type="text/javascript">
            const IMG_ARR =["media/images/", "media/images/", "media/images/", "media/images/", "media/images/", "media/images/"]
            counter = 0;
            counters = []
            
            $(document).ready(function(){
                $("#InfoModal").modal('show');
                $("#start-game").on(click, gameStart(), price_updated());
                $("#buy").on(click, gameStart());
            });


            function getRndInteger(min, max) {
                return Math.floor(Math.random() * (max - min) ) + min;
            }

            function gameStart() {
                
                random = getRndInteger(0,9); //random selection of images
                
                $(".e-wastes div").append("<img src="+imgs_arr[random]+"id=\"img"+counter+"\""+">");
                counters.append("img"+counter);
            }
            function price_updated() {
                price = parseInt($("#price span").text());
                price += 50;
                $("h4").text(price);
            }

            function allowDrop(ev) {
                ev.preventDefault();   //to change default settings from preventing dragging to allow it
            }
        
            function drag(ev) {
                ev.dataTransfer.setData("dd", ev.target.id);  // keep draggable element ID in global data collection reserved by the event object
                  // Setting public var
            }
        
            function drop(ev) {
                ev.preventDefault();
                var data = ev.dataTransfer.getData("dd");    //retrive draggable element ID
                ev.target.appendChild(document.getElementById(data)); // adding the draggable element to destination element
                //checking whether the dragged image match the concept by comparing the draggable image id and the destination div ID
                if(ev.target.id=="div1" && data=="drag4")
                    alert("correct");
                else
                if(ev.target.id=="div2" && data=="drag3")
                    alert("correct");
                else
                    if(ev.target.id=="div3" && data=="drag2")
                        alert("correct");
                    else
                        if(ev.target.id=="div4" && data=="drag1")
                            alert("correct");
                        else
                        {
                                alert("incorrect");
                                //return the incorrect image to its original div
                                (document.getElementById("div5")).appendChild(document.getElementById(data));
                        }
            }


        </script>
    </body>
</html>